!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";class t extends HTMLElement{constructor(){super(),this.isAnimating=!1,this.animationFrameId=null,this.elapsedTime=0,this.startTime=null,this.isGeneratingWave=!1,this.currentPath=null,this.targetPath=null,this.pendingTargetPath=null,this.intersectionObserver=null,this.observerOptions=null,this.random=Math.random,this.startEndZero=!1}connectedCallback(){const t=this.className,e=this.id??Math.random().toString(36).substring(7),n=this.getAttribute("style"),s=this.getAttribute("data-wave-face")||"top",a=parseInt(this.getAttribute("data-wave-points"),10);this.points=Number.isFinite(a)?Math.max(2,a):6;const r=this.getAttribute("data-wave-variance"),h=this.getAttribute("data-variance"),o=parseFloat(r??h??"");this.variance=Number.isFinite(o)?o:3,this.duration=parseFloat(this.getAttribute("data-wave-speed"))||7500;const c=this.getAttribute("data-wave-seed");this.random="string"==typeof c&&""!==c.trim()?function(t){let i=0;const e=String(t);for(let t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;let n=i>>>0;return function(){n+=1831565813;let t=n;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296}}(c):Math.random;const d=this.getAttribute("data-start-end-zero");this.startEndZero="string"==typeof d&&["","true","1","yes","on"].includes(d.trim().toLowerCase()),this.vertical="left"===s||"right"===s;const l="right"===s,m="bottom"===s;this.width=this.vertical?160:1440,this.height=this.vertical?1440:160,this.currentPath=i({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,random:this.random,startEndZero:this.startEndZero}),this.targetPath=i({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,random:this.random,startEndZero:this.startEndZero}),this.innerHTML=`\n      <svg \n        viewBox="${this.vertical?"0 0 160 1440":"0 0 1440 160"}"\n        preserveAspectRatio="none"\n        class="${t||""}"\n        style="${l?"transform:scaleX(-1);":""}${m?"transform:scaleY(-1);":""}${n||""}"\n        id="${e}"\n        aria-hidden="true"\n        role="presentation"\n      >\n        <path d="${this.currentPath}" style="stroke:inherit; fill: inherit"></path>\n      </svg>\n    `,this.svg=this.querySelector("svg"),this.path=this.querySelector("path"),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.generateNewWave=this.generateNewWave.bind(this);const v=this.getAttribute("data-wave-observe");v&&this.setupIntersectionObserver(v),"true"===this.getAttribute("data-wave-animate")&&("undefined"==typeof window||"function"!=typeof window.matchMedia||window.matchMedia("(prefers-reduced-motion: reduce)").matches||this.play())}play(t=null){if(this.isAnimating)return;this.isAnimating=!0;const e=t||this.duration,n=()=>{this.pendingTargetPath||(this.pendingTargetPath=i({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,random:this.random,startEndZero:this.startEndZero})),this.animateWave(e,(()=>{this.currentPath=this.targetPath,this.targetPath=this.pendingTargetPath,this.pendingTargetPath=i({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,random:this.random,startEndZero:this.startEndZero}),this.isAnimating&&n()}))};n()}pause(){this.isAnimating&&(this.isAnimating=!1,cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null,this.elapsedTime+=performance.now()-(this.startTime||performance.now()),this.startTime=null)}disconnectedCallback(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null)}setupIntersectionObserver(t){const[i,e="0px"]=t.split(":"),n="once"===i;this.observerOptions={root:null,rootMargin:e,threshold:0},"undefined"!=typeof window&&void 0!==window.IntersectionObserver?(this.intersectionObserver=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting||(this.generateNewWave(),n&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null))}))}),this.observerOptions),this.intersectionObserver.observe(this)):console.warn("IntersectionObserver is not available in this environment. Wave regeneration on intersection will be disabled.")}generateNewWave(t=800){this.isGeneratingWave||this.animationFrameId||(t<1&&(t=1),this.isGeneratingWave=!0,this.pendingTargetPath=i({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,random:this.random,startEndZero:this.startEndZero}),this.animateWave(t,(()=>{this.currentPath=this.targetPath,this.targetPath=this.pendingTargetPath,this.pendingTargetPath=null,this.isGeneratingWave=!1,this.animationFrameId=null})))}animateWave(t,n=null){const s=e(this.currentPath),a=e(this.targetPath);if(s.length!==a.length)return console.error("Point mismatch! Regenerating waves to ensure consistency."),this.currentPath=i({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,random:this.random,startEndZero:this.startEndZero}),void(this.targetPath=i({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,random:this.random,startEndZero:this.startEndZero}));const r=i=>{this.startTime||(this.startTime=i-this.elapsedTime);const e=i-this.startTime,h=Math.min(e/t,1),o=function(t,i,e,n=!1,s,a){const r=t.map(((t,s)=>{const a=i[s];return{cpX:t.cpX+(a.cpX-t.cpX)*e,cpY:n?t.cpY:t.cpY+(a.cpY-t.cpY)*e,x:n?t.x+(a.x-t.x)*e:t.x,y:n?t.y:t.y+(a.y-t.y)*e}}));let h=n?`M ${a} ${s} L ${r[0].x} ${s}`:`M 0 ${s} L 0 ${r[0].y}`;for(let t=0;t<r.length;t++){const{cpX:i,cpY:e,x:n,y:s}=r[t];h+=` Q ${i} ${e}, ${n} ${s}`}return h+=n?` L 0 0 L ${a} 0 L ${a} ${s} Z`:` L ${a} ${s} Z`,h}(s,a,h,this.vertical,this.height,this.width);this.path.setAttribute("d",o),h<1?this.animationFrameId=requestAnimationFrame(r):(this.elapsedTime=0,this.startTime=null,n&&n(),"function"==typeof CustomEvent&&this.dispatchEvent(new CustomEvent("dynamo-wave-complete",{detail:{duration:t,direction:this.vertical?"vertical":"horizontal"}})))};this.animationFrameId=requestAnimationFrame(r)}}function i({width:t,height:i,points:e,variance:n,vertical:s=!1,random:a=Math.random,startEndZero:r=!1}){const h=Math.max(2,Number.isFinite(e)?Math.floor(e):2),o=[],c=s?i/(h-1):t/(h-1);for(let e=0;e<h;e++){const r=s?i-c*e:c*e,h=s?t-.1*t-a()*(n*t*.25):i-.1*i-a()*(n*i*.25);o.push(s?{x:h,y:r}:{x:r,y:h})}r&&o.length&&(s?(o[0].x=t,o[o.length-1].x=0):(o[0].y=i,o[o.length-1].y=i));let d=s?`M ${t} ${i} L ${o[0].x} ${i}`:`M 0 ${i} L 0 ${o[0].y}`;for(let t=0;t<o.length-1;t++){const i=o[t],e=o[t+1],n=(i.x+e.x)/2,s=(i.y+e.y)/2;d+=` Q ${i.x} ${i.y}, ${n} ${s}`}const l=o[o.length-1];return d+=s?` Q ${l.x} ${l.y}, 0 0 L ${t} 0 L ${t} ${i} Z`:` Q ${l.x} ${l.y}, ${t} ${l.y} L ${t} ${i} Z`,d}function e(t){const i=[],e="[+-]?\\d*(?:\\.\\d+)?(?:[eE][+-]?\\d+)?",n=new RegExp(`Q\\s(${e})\\s(${e}),\\s(${e})\\s(${e})`,"g");let s;for(;null!==(s=n.exec(t));)i.push({cpX:parseFloat(s[1]),cpY:parseFloat(s[2]),x:parseFloat(s[3]),y:parseFloat(s[4])});return i}"undefined"!=typeof window&&window.customElements&&!window.customElements.get("dynamo-wave")&&window.customElements.define("dynamo-wave",t)}));
